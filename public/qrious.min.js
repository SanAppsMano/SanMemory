/*!
 * QRious v4.0.2
 * Copyright (C) 2017 Alasdair Mercer
 * MIT License
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).QRious={})}(this,function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}
var i=function(){function t(r){e(this,t),this._worker=r,this._callbacks=[],this._active=!1,this._worker.addEventListener("message",this._onMessage.bind(this),!1)}var i,n,o;return i=t,(n=[{key:"post",value:function(t){return this._active=!0,this._worker.postMessage(t),new Promise(this._addCallback.bind(this))}},{key:"_addCallback",value:function(t,e){this._callbacks.push({resolve:t,reject:e})}},{key:"_finish",value:function(t,e){var r=this._callbacks.shift();this._active=this._callbacks.length>0,e?r.reject(t):r.resolve(t),this._active&&this._worker.postMessage(this._callbacks[0].message)}},{key:"_onMessage",value:function(t){var e=t.data,r=e.error,i=e.result;r?this._finish(r,!0):this._finish(i,!1)}}])&&r(i.prototype,n),o&&r(i,o),t}();
function n(t,e){return Math.floor(Math.random()*(e-t+1))+t}var o=function(){function t(r){var i=this;e(this,t),this._options=r||{},this._worker=new Worker(r.worker||"qrious-worker.js"),this._helper=new i(this._worker),this._canvas=document.createElement("canvas"),this._image=document.createElement("img"),this._canvas._qrious=this,this._image._qrious=this,this.setOptions(r,!0)}var o,a,s;return o=t,(a=[{key:"canvas",get:function(){return this._canvas}},{key:"image",get:function(){return this._image}},{key:"setOptions",value:function(t,e){for(var r in t)this._setOption(r,t[r],e);return this}},{key:"_setOption",value:function(t,e,r){switch(t){case"background":case"backgroundAlpha":case"foreground":case"foregroundAlpha":case"level":case"mime":this["_"+t]=e,r||this.update();break;case"padding":case"size":this["_"+t]=e,r||this.update();break;case"value":this._value=""+e,r||this.update()}}},{key:"update",value:function(){var t=this,e=this._value;if(!e)return this._canvas,this._image;var r=this._helper.post({canvas:this._canvas,options:{background:this._background,backgroundAlpha:this._backgroundAlpha,foreground:this._foreground,foregroundAlpha:this._foregroundAlpha,level:this._level,mime:this._mime,padding:this._padding,size:this._size,value:e}});return r.then(function(e){t._image.src=e}),this._canvas,this._image}}])&&r(o.prototype,a),s&&r(o,s),t}();
t.QRious=o,Object.defineProperty(t,"__esModule",{value:!0})});
